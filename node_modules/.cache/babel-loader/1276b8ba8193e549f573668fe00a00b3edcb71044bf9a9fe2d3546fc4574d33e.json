{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\My\\\\306project\\\\src\\\\pages\\\\AdminPage.js\",\n  _s = $RefreshSig$();\n// src/pages/AdminPage.js\nimport React, { useState, useEffect } from 'react';\nimport { db } from '../firebase/config';\nimport { collection, query, orderBy, onSnapshot, addDoc, serverTimestamp } from 'firebase/firestore';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction AdminPage() {\n  _s();\n  const [conversations, setConversations] = useState({});\n  const [selectedUser, setSelectedUser] = useState(null);\n  const [reply, setReply] = useState('');\n  useEffect(() => {\n    const q = query(collection(db, \"support_messages\"), orderBy(\"timestamp\", \"asc\"));\n    const unsubscribe = onSnapshot(q, snapshot => {\n      const messagesByUser = {};\n      snapshot.forEach(doc => {\n        const message = {\n          id: doc.id,\n          ...doc.data()\n        };\n        if (!messagesByUser[message.userId]) {\n          messagesByUser[message.userId] = [];\n        }\n        messagesByUser[message.userId].push(message);\n      });\n      setConversations(messagesByUser);\n    });\n    return () => unsubscribe();\n  }, []);\n  const handleReply = async e => {\n    e.preventDefault();\n    try {\n      await addDoc(collection(db, \"support_messages\"), {\n        name: 'Admin',\n        message: reply,\n        timestamp: serverTimestamp(),\n        userId: selectedUser,\n        isAdmin: true\n      });\n      setReply('');\n    } catch (error) {\n      console.error(\"Error sending reply: \", error);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"grid grid-cols-12 gap-4 p-4\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"col-span-4\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white shadow rounded-lg p-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-xl font-bold mb-4\",\n          children: \"Conversations\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 47,\n          columnNumber: 10\n        }, this), Object.entries(conversations).map(([userId, messages]) => /*#__PURE__*/_jsxDEV(\"div\", {\n          onClick: () => setSelectedUser(userId),\n          className: `p-3 rounded cursor-pointer ${selectedUser === userId ? 'bg-blue-100' : 'hover:bg-gray-100'}`,\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"font-semibold\",\n            children: messages[0].name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 56,\n            columnNumber: 14\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-sm text-gray-600\",\n            children: messages[0].subject\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 57,\n            columnNumber: 14\n          }, this)]\n        }, userId, true, {\n          fileName: _jsxFileName,\n          lineNumber: 49,\n          columnNumber: 12\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 46,\n        columnNumber: 8\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 6\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"col-span-8\",\n      children: selectedUser && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white shadow rounded-lg p-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"h-[calc(100vh-200px)] overflow-y-auto space-y-4\",\n          children: conversations[selectedUser].map(msg => {\n            var _msg$timestamp;\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `flex ${msg.isAdmin ? 'justify-end' : ''}`,\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: `p-3 rounded-lg max-w-[70%] ${msg.isAdmin ? 'bg-blue-100' : 'bg-gray-100'}`,\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"font-semibold\",\n                  children: msg.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 72,\n                  columnNumber: 20\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: msg.message\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 73,\n                  columnNumber: 20\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-xs text-gray-500\",\n                  children: (_msg$timestamp = msg.timestamp) === null || _msg$timestamp === void 0 ? void 0 : _msg$timestamp.toDate().toLocaleString()\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 74,\n                  columnNumber: 20\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 69,\n                columnNumber: 18\n              }, this)\n            }, msg.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 68,\n              columnNumber: 16\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 12\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: handleReply,\n          className: \"mt-4 flex gap-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            value: reply,\n            onChange: e => setReply(e.target.value),\n            placeholder: \"Type your reply...\",\n            className: \"flex-1 p-2 border rounded\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 82,\n            columnNumber: 14\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            className: \"bg-blue-500 text-white px-4 py-2 rounded\",\n            children: \"Send\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 89,\n            columnNumber: 14\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 12\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 10\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 6\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 44,\n    columnNumber: 4\n  }, this);\n}\n_s(AdminPage, \"bVz/uOlB74OYDtQVC/ymXbe+PoQ=\");\n_c = AdminPage;\nexport default AdminPage;\nvar _c;\n$RefreshReg$(_c, \"AdminPage\");","map":{"version":3,"names":["React","useState","useEffect","db","collection","query","orderBy","onSnapshot","addDoc","serverTimestamp","jsxDEV","_jsxDEV","AdminPage","_s","conversations","setConversations","selectedUser","setSelectedUser","reply","setReply","q","unsubscribe","snapshot","messagesByUser","forEach","doc","message","id","data","userId","push","handleReply","e","preventDefault","name","timestamp","isAdmin","error","console","className","children","fileName","_jsxFileName","lineNumber","columnNumber","Object","entries","map","messages","onClick","subject","msg","_msg$timestamp","toDate","toLocaleString","onSubmit","type","value","onChange","target","placeholder","_c","$RefreshReg$"],"sources":["C:/Users/My/306project/src/pages/AdminPage.js"],"sourcesContent":["// src/pages/AdminPage.js\r\nimport React, { useState, useEffect } from 'react';\r\nimport { db } from '../firebase/config';\r\nimport { collection, query, orderBy, onSnapshot, addDoc, serverTimestamp } from 'firebase/firestore';\r\n\r\nfunction AdminPage() {\r\n const [conversations, setConversations] = useState({});\r\n const [selectedUser, setSelectedUser] = useState(null);\r\n const [reply, setReply] = useState('');\r\n\r\n useEffect(() => {\r\n   const q = query(collection(db, \"support_messages\"), orderBy(\"timestamp\", \"asc\"));\r\n   const unsubscribe = onSnapshot(q, (snapshot) => {\r\n     const messagesByUser = {};\r\n     snapshot.forEach(doc => {\r\n       const message = { id: doc.id, ...doc.data() };\r\n       if (!messagesByUser[message.userId]) {\r\n         messagesByUser[message.userId] = [];\r\n       }\r\n       messagesByUser[message.userId].push(message);\r\n     });\r\n     setConversations(messagesByUser);\r\n   });\r\n   return () => unsubscribe();\r\n }, []);\r\n\r\n const handleReply = async (e) => {\r\n   e.preventDefault();\r\n   try {\r\n     await addDoc(collection(db, \"support_messages\"), {\r\n       name: 'Admin',\r\n       message: reply,\r\n       timestamp: serverTimestamp(),\r\n       userId: selectedUser,\r\n       isAdmin: true\r\n     });\r\n     setReply('');\r\n   } catch (error) {\r\n     console.error(\"Error sending reply: \", error);\r\n   }\r\n };\r\n\r\n return (\r\n   <div className=\"grid grid-cols-12 gap-4 p-4\">\r\n     <div className=\"col-span-4\">\r\n       <div className=\"bg-white shadow rounded-lg p-4\">\r\n         <h2 className=\"text-xl font-bold mb-4\">Conversations</h2>\r\n         {Object.entries(conversations).map(([userId, messages]) => (\r\n           <div\r\n             key={userId}\r\n             onClick={() => setSelectedUser(userId)}\r\n             className={`p-3 rounded cursor-pointer ${\r\n               selectedUser === userId ? 'bg-blue-100' : 'hover:bg-gray-100'\r\n             }`}\r\n           >\r\n             <p className=\"font-semibold\">{messages[0].name}</p>\r\n             <p className=\"text-sm text-gray-600\">{messages[0].subject}</p>\r\n           </div>\r\n         ))}\r\n       </div>\r\n     </div>\r\n     \r\n     <div className=\"col-span-8\">\r\n       {selectedUser && (\r\n         <div className=\"bg-white shadow rounded-lg p-4\">\r\n           <div className=\"h-[calc(100vh-200px)] overflow-y-auto space-y-4\">\r\n             {conversations[selectedUser].map(msg => (\r\n               <div key={msg.id} className={`flex ${msg.isAdmin ? 'justify-end' : ''}`}>\r\n                 <div className={`p-3 rounded-lg max-w-[70%] ${\r\n                   msg.isAdmin ? 'bg-blue-100' : 'bg-gray-100'\r\n                 }`}>\r\n                   <p className=\"font-semibold\">{msg.name}</p>\r\n                   <p>{msg.message}</p>\r\n                   <p className=\"text-xs text-gray-500\">\r\n                     {msg.timestamp?.toDate().toLocaleString()}\r\n                   </p>\r\n                 </div>\r\n               </div>\r\n             ))}\r\n           </div>\r\n           <form onSubmit={handleReply} className=\"mt-4 flex gap-2\">\r\n             <input\r\n               type=\"text\"\r\n               value={reply}\r\n               onChange={(e) => setReply(e.target.value)}\r\n               placeholder=\"Type your reply...\"\r\n               className=\"flex-1 p-2 border rounded\"\r\n             />\r\n             <button type=\"submit\" className=\"bg-blue-500 text-white px-4 py-2 rounded\">\r\n               Send\r\n             </button>\r\n           </form>\r\n         </div>\r\n       )}\r\n     </div>\r\n   </div>\r\n );\r\n}\r\n\r\nexport default AdminPage;\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}